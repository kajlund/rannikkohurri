var angular=angular||null;!function(e){"use strict";var t={radius:40,lines:7,length:0,width:30,speed:1.7,corners:1,trail:100,color:"#333",zIndex:2e9,left:"auto",top:"200px"},o=e.module("app",["ui.router","ngAnimate","ngCookies","infinite-scroll","mgcrea.ngStrap","ngGrid"]);o.config(["$stateProvider","$urlRouterProvider","$httpProvider","$modalProvider",function(t,o,r,n){r.defaults.headers.common["X-Parse-Application-Id"]="HZAMesseJ6CDe1K5dFLfxbGbMYD6aV3lBaEp3Ib1",r.defaults.headers.common["X-Parse-REST-API-Key"]="LZqwu8VIutbaphzVoPW7yf4RxkKQAMbAapwubT5L",e.extend(n.defaults,{animation:"am-fade-and-scale",placement:"center",html:!0}),o.when("/posts","/posts/list"),o.otherwise("home"),t.state("home",{url:"/home",templateUrl:"app/home.html",controller:"HomeController"}).state("posts",{"abstract":!0,url:"/posts",templateUrl:"app/posts/posts.html"}).state("posts.list",{url:"/list",templateUrl:"app/posts/list.html",controller:"postListController"}).state("posts.detail",{url:"/:slug",templateUrl:"app/posts/detail.html",controller:"PostDetailController"}).state("links",{url:"/links",templateUrl:"app/links/links.html",controller:"LinksController"}).state("about",{url:"/about",templateUrl:"app/about.html",controller:"AboutController"}).state("books",{url:"/books",templateUrl:"app/books/list.html",controller:"bookListController"}).state("bookedit",{url:"/books:bookId",templateUrl:"app/books/edit.html",controller:"bookEditController"}).state("movies",{url:"/movies",templateUrl:"app/movies/list.html",controller:"movieListController"}).state("movieedit",{url:"/movies:movieId",templateUrl:"app/movies/edit.html",controller:"movieEditController"}).state("events",{url:"/events",templateUrl:"app/events/list.html",controller:"EventListController"}).state("eventedit",{url:"/events:eventId",templateUrl:"app/events/edit.html",controller:"eventEditController"}).state("cheats",{url:"/cheats",templateUrl:"app/cheats/list.html",controller:"cheatsListController"}).state("cheatsedit",{url:"/cheats/:cacheId",templateUrl:"app/cheats/edit.html",controller:"cheatsEditController"})}]),o.run(["$rootScope","$state","$stateParams","$log","$window",function(e,o,r,n,a){e.busy=function(o){o?(e.spinner||(e.spinner=new a.Spinner(t)),e.spinner.spin(a.document.documentElement)):e.spinner&&e.spinner.stop()},a.toastr.options.timeOut=2e3,a.toastr.options.positionClass="toast-bottom-right",a.marked.setOptions({gfm:!0}),e.$state=o,e.$stateParams=r,n.info("App Loaded")}]),o.directive("aDisabled",function(){return{restrict:"A",priority:-99999,link:function(e,t,o){e.$watch(o.aDisabled,function(r,n){r?t.unbind("click"):n&&t.bind("click",function(){e.$apply(o.ngClick)})})}}})}(angular),function(e){"use strict";e.module("app").controller("AboutController",["$scope","$rootScope","$location","$log",function(){}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e,t){"use strict";e.module("app").controller("headerController",["$scope","$rootScope","$location","$log","$modal","SessionService",function(e,o,r,n,a,i){var s=a({scope:e,template:"app/signon.html",show:!1});e.session=i,e.user={name:"",pwd:""},e.getClass=function(e){var t="";return r.path().substr(0,e.length)===e&&(t="active"),t},e.login=function(){s.hide(),i.signon(e.user.name,e.user.pwd).then(function(){t.info(i.userObj.username+" signed on")},function(e){t.error(e.error)})},e.onSignonClick=function(){s.$promise.then(s.show)},e.onSignoffClick=function(){n.info("Signing off"),i.signoff(),t.warning("User signed off")}}])}(angular,toastr);var angular=angular||null;!function(e){"use strict";e.module("app").controller("HomeController",["$scope","$rootScope","$location","$log","$modal","SessionService",function(e,t,o,r,n,a){e.session=a,a.loggedOn()||(t.busy(!0),r.info("not logged on"),a.autoSignon().then(function(){r.info(e.session),t.busy(!1)},function(e){r.error(e),t.busy(!1)}))}])}(angular),function(e){"use strict";e.module("app").factory("SessionService",["$rootScope","$http","$cookieStore","$log","$q",function(e,t,o,r,n){function a(e){s.userObj=e,s.sessionToken=e.sessionToken,o.put("ParseUser",e)}function i(){s.userObj=null,s.sessionToken="",o.remove("ParseUser")}var s={};return s.sessionToken="",s.userObj=null,s.autoSignon=function(){var e=o.get("ParseUser"),i={headers:{"X-Parse-Application-Id":"HZAMesseJ6CDe1K5dFLfxbGbMYD6aV3lBaEp3Ib1","X-Parse-REST-API-Key":"LZqwu8VIutbaphzVoPW7yf4RxkKQAMbAapwubT5L","X-Parse-Session-Token":e?e.sessionToken:""},method:"GET",url:"https://api.parse.com/1/users/me"},s=n.defer();return e&&e.sessionToken.length>10?t(i).success(function(e){r.info("autoSignon success, data = %o",e),a(e),s.resolve(e)}).error(function(e){s.reject(e.error)}):s.reject("Invalid Cookie"),s.promise},s.loggedOn=function(){return null!==s.userObj},s.signoff=function(){i()},s.signon=function(e,o){var r="?username="+e+"&password="+o,s={method:"GET",url:" https://api.parse.com/1/login"+r};return t(s).then(function(e){return"object"==typeof e.data?(a(e.data),e.data):(i(),n.reject(e.data))},function(e){return i(),n.reject(e.data)})},s}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("bookEditController",["$scope","$rootScope","$state","$log","SessionService","bookDataService",function(e,t,o,r,n,a){e.session=n,e.bookId=t.$stateParams.bookId,e.languages=["swe","eng","fin"],e.genres=["Biography","History","Kids","Misc","Novel","Science","Technology"],"_new"===e.bookId?e.book={authors:"",genre:"",image:"",lang:"",subtitle:"",title:""}:a.getItem(e.bookId).then(function(t){e.book=t.data},function(e){r.error(e),toastr.error(e.error.code+" "+e.error.error),o.go("books")}),e.save=function(){a.updateItem(e.book).then(function(e){r.info("Saved Book %o",e),toastr.success("Book saved"),o.go("books")},function(e){r.error("Error saving Book %o",e),toastr.error(e.error.code+" "+e.error.error),o.go("books")})},e.cancel=function(){r.info("Cancelled Edit"),toastr.warning("Edit cancelled"),o.go("books")}}])}(angular.module("app"));var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("bookListController",["$scope","$rootScope","$state","$log","$modal","SessionService","bookDataService",function(e,t,o,r,n,a,i){function s(){e.fetching||(e.fetching=!0,t.busy(!0),i.getPage(e.order,e.filter,e.currentPage).then(function(o){e.items=e.items.concat(o.data.results),e.totalItems=o.data.count,t.busy(!1),e.fetching=!1},function(o){t.busy(!1),r.error(o),toastr.error(o.error.code+" "+o.error.error),e.fetching=!1}))}var l=null;e.session=a,e.filter="",e.currentPage=1,e.maxSize=10,e.order="title",e.totalItems=0,e.currentItem=null,e.items=[],e.fetching=!1,s(),e.onAddClick=function(){o.go("bookedit",{bookId:"_new"})},e.onEditClick=function(e){o.go("bookedit",{bookId:e.objectId})},e.onDeleteClick=function(t){e.currentItem=t,l=n({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Book?",content:"You are about to delete book <em>"+t.title+"</em>"})},e.dlgVerifyCancel=function(){l.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){l.hide(),t.busy(!0),i.deleteItem(e.currentItem).then(function(){r.info("Deleted Book"),toastr.success("Book deleted"),e.items=_.filter(e.items,function(t){return t.objectId!==e.currentItem.objectId}),t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})},e.scroll=function(){e.currentPage+=1,s()}}])}(angular.module("app"));var angular=angular||null;!function(e){"use strict";e.module("app").factory("bookDataService",["$log","$q","$http","SessionService",function(e,t,o,r){var n="https://api.parse.com/1/classes/AudioBook",a={};return a.pageSize=100,a.getItem=function(e){var t={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"/"+e};return o(t)},a.getItems=function(){var e={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"?count=1&limit=1000&order=title"};return o(e)},a.getPage=function(e,t,i){var s=""===t?"":'&where={"'+e+'":{"$gte":"'+t+'"}}',l=(i-1)*a.pageSize,u="?count=1&limit="+a.pageSize+"&skip="+l+"&order="+e+s,c={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+u};return o(c)},a.updateItem=function(e){var t=void 0===e.objectId,a=t?n+"/":n+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":r.sessionToken},method:t?"POST":"PUT",url:a,data:e};return o(i)},a.deleteItem=function(e){var t=n+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":r.sessionToken},method:"DELETE",url:t};return o(a)},a}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("cheatsEditController",["$scope","$rootScope","$state","$log","SessionService","cheatsDataService",function(e,t,o,r,n,a){e.session=n,e.cacheId=t.$stateParams.cacheId,e.cacheTypes=["Tradi","Mystery","Multi","Chirp","Earth","Letterbox","Event","Lab","Virtual","Wherigo"],e.municipalities=["Akaa","Alajärvi","Alavieska","Alavus","Asikkala","Askola","Aura","Brändö","Eckerö","Enonkoski","Enontekiö","Espoo","Eura","Eurajoki","Evijärvi","Finström","Forssa","Föglö","Geta","Haapajärvi","Haapavesi","Hailuoto","Halsua","Hamina","Hammarland","Hankasalmi","Hanko","Harjavalta","Hartola","Hattula","Hausjärvi","Heinola","Heinävesi","Helsinki","Hirvensalmi","Hollola","Honkajoki","Huittinen","Humppila","Hyrynsalmi","Hyvinkää","Hämeenkoski","Hämeenkyrö","Hämeenlinna","Ii","Iisalmi","Iitti","Ikaalinen","Ilmajoki","Ilomantsi","Imatra","Inari","Inkoo","Isojoki","Isokyrö","Jalasjärvi","Janakkala","Joensuu","Jokioinen","Jomala","Joroinen","Joutsa","Juankoski","Juuka","Juupajoki","Juva","Jyväskylä","Jämijärvi","Jämsä","Järvenpää","Kaarina","Kaavi","Kajaani","Kalajoki","Kangasala","Kangasniemi","Kankaanpää","Kannonkoski","Kannus","Karijoki","Karkkila","Karstula","Karvia","Kaskinen","Kauhajoki","Kauhava","Kauniainen","Kaustinen","Keitele","Kemi","Kemijärvi","Keminmaa","Kemiönsaari","Kempele","Kerava","Keuruu","Kihniö","Kinnula","Kirkkonummi","Kitee","Kittilä","Kiuruvesi","Kivijärvi","Kokemäki","Kokkola","Kolari","Konnevesi","Kontiolahti","Korsnäs","Koski Tl","Kotka","Kouvola","Kristiinankaupunki","Kruunupyy","Kuhmo","Kuhmoinen","Kumlinge","Kuopio","Kuortane","Kurikka","Kustavi","Kuusamo","Kyyjärvi","Kärkölä","Kärsämäki","Kökar","Köyliö","Lahti","Laihia","Laitila","Lapinjärvi","Lapinlahti","Lappajärvi","Lappeenranta","Lapua","Laukaa","Lavia","Lemi","Lemland","Lempäälä","Leppävirta","Lestijärvi","Lieksa","Lieto","Liminka","Liperi","Lohja","Loimaa","Loppi","Loviisa","Luhanka","Lumijoki","Lumparland","Luoto","Luumäki","Luvia","Maalahti","Maaninka","Maarianhamina","Marttila","Masku","Merijärvi","Merikarvia","Miehikkälä","Mikkeli","Muhos","Multia","Muonio","Mustasaari","Muurame","Mynämäki","Myrskylä","Mäntsälä","Mänttä-Vilppula","Mäntyharju","Naantali","Nakkila","Nastola","Nivala","Nokia","Nousiainen","Nurmes","Nurmijärvi","Närpiö","Orimattila","Oripää","Orivesi","Oulainen","Oulu","Outokumpu","Padasjoki","Paimio","Paltamo","Parainen","Parikkala","Parkano","Pedersöre","Pelkosenniemi","Pello","Perho","Pertunmaa","Petäjävesi","Pieksämäki","Pielavesi","Pietarsaari","Pihtipudas","Pirkkala","Polvijärvi","Pomarkku","Pori","Pornainen","Porvoo","Posio","Pudasjärvi","Pukkila","Punkalaidun","Puolanka","Puumala","Pyhtää","Pyhäjoki","Pyhäjärvi","Pyhäntä","Pyhäranta","Pälkäne","Pöytyä","Raahe","Raasepori","Raisio","Rantasalmi","Ranua","Rauma","Rautalampi","Rautavaara","Rautjärvi","Reisjärvi","Riihimäki","Ristijärvi","Rovaniemi","Ruokolahti","Ruovesi","Rusko","Rääkkylä","Saarijärvi","Salla","Salo","Saltvik","Sastamala","Sauvo","Savitaipale","Savonlinna","Savukoski","Seinäjoki","Sievi","Siikainen","Siikajoki","Siikalatva","Siilinjärvi","Simo","Sipoo","Siuntio","Sodankylä","Soini","Somero","Sonkajärvi","Sotkamo","Sottunga","Sulkava","Sund","Suomussalmi","Suonenjoki","Sysmä","Säkylä","Taipalsaari","Taivalkoski","Taivassalo","Tammela","Tampere","Tarvasjoki","Tervo","Tervola","Teuva","Tohmajärvi","Toholampi","Toivakka","Tornio","Turku","Tuusniemi","Tuusula","Tyrnävä","Ulvila","Urjala","Utajärvi","Utsjoki","Uurainen","Uusikaarlepyy","Uusikaupunki","Vaala","Vaasa","Valkeakoski","Valtimo","Vantaa","Varkaus","Vehmaa","Vesanto","Vesilahti","Veteli","Vieremä","Vihti","Viitasaari","Vimpeli","Virolahti","Virrat","Vårdö","Vöyri","Ylitornio","Ylivieska","Ylöjärvi","Ypäjä","Ähtäri","Äänekoski"],"_new"===e.cacheId?e.cache={cacheId:"",cacheType:"",name:"",coords:"",verifiedCoords:!1}:a.getItem(e.cacheId).then(function(t){e.cache=t.data,e.currentType=e.cache.cacheType},function(e){r.error(e),toastr.error(e.error.code+" "+e.error.error),o.go("cheats")}),e.save=function(){a.updateItem(e.cache).then(function(e){r.info("Saved Cache %o",e),toastr.success("Cache saved"),o.go("cheats")},function(e){r.error("Error saving Cache %o",e),toastr.error(e.error.code+" "+e.error.error),o.go("cheats")})},e.cancel=function(){r.info("Cancelled Edit"),toastr.warning("Edit cancelled"),o.go("cheats")}}])}(angular.module("app"));var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("cheatsListController",["$scope","$rootScope","$state","$log","$modal","SessionService","cheatsDataService",function(e,t,o,r,n,a,i){function s(){t.busy(!0),i.getItems().then(function(o){r.info(o),e.items=o.data.results,t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})}var l=null,u='<div class="ngCellText" ng-class="col.colIndex()">  <a target="_blank" href="http://coord.info/{{row.entity.cacheId}}">{{row.getProperty(col.field)}}</a></div>',c='<div class="ngCellText" ng-class="col.colIndex()">  <div class="btn-group">    <button type="button" class="btn btn-primary" data-ng-click="onEditClick(row.entity)">        <i class="fa fa-edit"></i>    </button>    <button type="button" class="btn btn-danger" data-ng-click="onDeleteClick(row.entity)">      <i class="fa fa-trash-o"></i>    </button>  </div></div>';e.gridOptions={data:"items",rowHeight:44,multiSelect:!1,showGroupPanel:!0,columnDefs:[{field:"cacheId",displayName:"Id",width:"100",cellTemplate:u},{field:"updatedAt",displayName:"Updated",cellFilter:"date",width:"100"},{field:"cacheType",displayName:"Type",width:"100"},{field:"name",displayName:"Name"},{field:"municipality",displayName:"Municipality",width:"150"},{field:"coords",displayName:"Coords"},{field:"verifiedCoords",displayName:"Verified",width:"66"},{field:"objectId",displayName:"Commands",width:"86",cellTemplate:c}]},e.session=a,e.totalItems=0,e.currentItem=null,s(),e.onAddClick=function(){o.go("cheatsedit",{cacheId:"_new"})},e.onEditClick=function(e){o.go("cheatsedit",{cacheId:e.objectId})},e.onDeleteClick=function(t){e.currentItem=t,l=n({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Cache?",content:"You are about to delete cache <strong>"+t.name+"</strong>"})},e.dlgVerifyCancel=function(){l.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){l.hide(),t.busy(!0),i.deleteItem(e.currentItem).then(function(){r.info("Deleted Cache"),toastr.success("Cache deleted"),e.items=_.filter(e.items,function(t){return t.objectId!==e.currentItem.objectId}),t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})}}])}(angular.module("app"));var angular=angular||null;!function(e){"use strict";e.factory("cheatsDataService",["$log","$q","$http","SessionService",function(e,t,o,r){var n="https://api.parse.com/1/classes/Cheat",a={};return a.municipalities=[],a.getItem=function(e){var t={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"/"+e};return o(t)},a.getItems=function(){var e={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"?count=1&limit=1000&order=name"};return o(e)},a.updateItem=function(e){var t=void 0===e.objectId,a=t?n+"/":n+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":r.sessionToken},method:t?"POST":"PUT",url:a,data:e};return o(i)},a.deleteItem=function(e){var t=n+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":r.sessionToken},method:"DELETE",url:t};return o(a)},a}])}(angular.module("app"));var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.module("app").controller("eventEditController",["$scope","$rootScope","$state","$log","SessionService","eventDataService",function(e,t,o,r,n,a){e.session=n,e.eventId=t.$stateParams.eventId,"_new"===e.eventId?e.event={starts:"",eventName:"",placeName:"",organizer:"",organizerUrl:"",smartum:!1}:a.getEvent(e.eventId).then(function(t){e.event=t.data},function(e){r.error(e),toastr.error(e.error.code+" "+e.error.error),o.go("events")}),e.save=function(){a.updateItem(e.event).then(function(e){r.info("Saved Event %o",e),toastr.success("Event saved"),o.go("events")},function(e){r.error("Error saving Event %o",e),toastr.error(e.error.code+" "+e.error.error),o.go("events")})},e.cancel=function(){r.info("Cancelled Edit"),toastr.warning("Edit cancelled"),o.go("events")}}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("EventListController",["$scope","$rootScope","$state","$log","$modal","SessionService","eventDataService",function(e,t,o,r,n,a,i){function s(){t.busy(!0),i.getEvents().then(function(o){e.events=o.data.results,t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})}var l=null;e.session=a,e.totalItems=0,e.currentItem=null,s(),e.onAddClick=function(){o.go("eventedit",{eventId:"_new"})},e.onEditClick=function(e){o.go("eventedit",{eventId:e.objectId})},e.onDeleteClick=function(t){e.currentItem=t,l=n({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Event?",content:"You are about to delete event <em>"+t.eventName+"/"+t.placeName+"</em>"})},e.dlgVerifyCancel=function(){l.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){l.hide(),t.busy(!0),i.deleteItem(e.currentItem).then(function(){r.info("Deleted Event"),toastr.success("Event deleted"),e.events=_.filter(e.events,function(t){return t.objectId!==e.currentItem.objectId}),t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})}}])}(angular.module("app"));var angular=angular||null;!function(e){"use strict";e.module("app").factory("eventDataService",["$log","$q","$http","SessionService",function(e,t,o,r){var n="https://api.parse.com/1/classes/Event",a={};return a.getEvent=function(e){var t={isArray:!1,method:"GET",url:n+"/"+e};return o(t)},a.getEvents=function(){var e={isArray:!1,method:"GET",url:n+"?count=1&limit=1000&order=starts"};return o(e)},a.updateItem=function(e){var t=void 0===e.objectId,a=t?n+"/":n+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":r.sessionToken},method:t?"POST":"PUT",url:a,data:e};return o(i)},a.deleteItem=function(e){var t=n+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":r.sessionToken},method:"DELETE",url:t};return o(a)},a}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e,t){"use strict";e.controller("movieEditController",["$scope","$rootScope","$state","$log","SessionService","movieDataService",function(e,o,r,n,a,i){e.session=a,e.movieId=o.$stateParams.movieId,"_new"===e.movieId?e.movie={seenAt:{__type:"Date",iso:(new Date).toISOString()},etitle:"",otitle:"",pic:"",rating:0,url:"",synopsis:"",comment:""}:i.getItem(e.movieId).then(function(t){e.movie=t.data},function(e){n.error(e),t.error(e.error.code+" "+e.error.error),r.go("movies")}),e.save=function(){i.updateItem(e.movie).then(function(e){n.info("Saved Movie %o",e),t.success("Movie saved"),r.go("movies")},function(e){n.error("Error saving Movie %o",e),t.error(e.error.code+" "+e.error.error),r.go("movies")})},e.cancel=function(){n.info("Cancelled Edit"),t.warning("Edit cancelled"),r.go("movies")}}])}(angular.module("app"),toastr);var angular=angular||null,toastr=toastr||null;!function(e){"use strict";e.controller("movieListController",["$scope","$rootScope","$modal","$log","$state","SessionService","movieDataService",function(e,t,o,r,n,a,i){function s(){e.fetching||(e.fetching=!0,t.busy(!0),i.getPage(e.order,e.filter,e.currentPage).then(function(o){e.items=e.items.concat(o.data.results),e.totalItems=o.data.count,t.busy(!1),e.fetching=!1},function(o){t.busy(!1),r.error(o),toastr.error(o.error.code+" "+o.error.error),e.fetching=!1}))}var l=null;e.session=a,e.filter="",e.currentPage=1,e.maxSize=10,e.order="-seenAt",e.totalItems=0,e.currentItem=null,e.items=[],e.fetching=!1,s(),e.onAddClick=function(){n.go("movieedit",{movieId:"_new"})},e.onEditClick=function(e){n.go("movieedit",{movieId:e.objectId})},e.onDeleteClick=function(t){e.currentItem=t,l=o({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Movie?",content:"You are about to delete movie <em>"+t.etitle+"</em>"})},e.dlgVerifyCancel=function(){l.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){l.hide(),t.busy(!0),i.deleteItem(e.currentItem).then(function(){r.info("Deleted Movie"),toastr.success("Movie deleted"),e.items=_.filter(e.items,function(t){return t.objectId!==e.currentItem.objectId}),t.busy(!1)},function(e){t.busy(!1),r.error(e),toastr.error(e.error.code+" "+e.error.error)})},e.scroll=function(){e.currentPage+=1,s()}}])}(angular.module("app"));var angular=angular||null;!function(e){"use strict";e.factory("movieDataService",["$log","$q","$http","SessionService",function(e,t,o,r){var n="https://api.parse.com/1/classes/Movie",a={};return a.pageSize=100,a.getItem=function(e){var t={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"/"+e};return o(t)},a.getItems=function(){var e={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+"?count=1&limit=1000&order=-seenAt"};return o(e)},a.getPage=function(e,t,i){var s=""===t?"":'&where={"'+e+'":{"$gte":"'+t+'"}}',l=(i-1)*a.pageSize,u="?count=1&limit="+a.pageSize+"&skip="+l+"&order="+e+s,c={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+u};return o(c)},a.updateItem=function(e){var t=void 0===e.objectId,a=t?n+"/":n+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":r.sessionToken},method:t?"POST":"PUT",url:a,data:e};return o(i)},a.deleteItem=function(e){var t=n+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":r.sessionToken},method:"DELETE",url:t};return o(a)},a}])}(angular.module("app")),function(e){"use strict";e.module("app").controller("postDeleteController",["$scope","$modalInstance","post",function(e,t,o){e.post=o,e.ok=function(){t.close("OK")},e.cancel=function(){t.dismiss("Cancel")}}])}(angular);var angular=angular||null,marked=marked||null,toastr=toastr||null;!function(e,t,o){"use strict";e.module("app").controller("PostDetailController",["$scope","$rootScope","$stateParams","$http","$sce","$log","PostDataService",function(e,r,n,a,i,s,l){function u(r){s.info("slug = "+r.slug),a.get("/dropbox/"+r.slug).then(function(o){e.markdown=i.trustAsHtml(t(o.data))},function(e){s.error(e),o.error(e.error.code+" "+e.error.error)})}e.currentPost=null,r.busy(!0),n.slug&&(s.info("post = "+n.slug),l.getPost(n.slug).then(function(t){s.info("res = %o",t),e.currentPost=t.data.results[0],e.title=e.currentPost.title,u(e.currentPost),r.busy(!1)},function(t){r.busy(!1),e.currentPost=null,s.error(t),o.error(t.error.code+" "+t.error.error)}))}])}(angular,marked,toastr),function(e){"use strict";e.module("app").controller("postEditController",["$scope","$modalInstance","post",function(e,t,o){e.post=o,e.ok=function(){t.close("OK")},e.cancel=function(){t.dismiss("Cancel")}}])}(angular);var angular=angular||null,toastr=toastr||null;!function(e,t){"use strict";e.module("app").controller("postListController",["$scope","$rootScope","$log","$modal","PostDataService",function(e,o,r,n,a){o.busy(!0),a.getPosts().then(function(t){r.info(t),e.posts=t.data.results,o.busy(!1)},function(e){o.busy(!1),r.error(e),t.error(e.error.code+" "+e.error.error)}),e.onAddClick=function(){var e=new a.PostModel,o=n.open({templateUrl:"app/posts/edit.html",controller:"postEditController",resolve:{post:function(){return e}}});o.result.then(function(){e.save(null,{success:function(){t.success("Post added")},error:function(e,o){t.error(o.description)}})},function(){r.info("Cancel"),t.warning("Edit cancelled")})},e.onEditClick=function(e){var o={slug:e.get("slug"),title:e.get("title"),excerpt:e.get("excerpt"),tags:e.get("tags"),published:e.get("published"),publishDate:e.get("publishDate")},a=n.open({templateUrl:"app/posts/edit.html",controller:"postEditController",resolve:{post:function(){return o}}});a.result.then(function(){o.save({success:function(){t.success("Post updated")},error:function(e,o){t.error(o.description)}})},function(){r.info("Cancel"),t.warning("Edit cancelled")})},e.onDeleteClick=function(e){r.info("Deleting post %o",e);var o=e,a=n.open({templateUrl:"app/posts/delete.html",controller:"postDeleteController",resolve:{post:function(){return o}}});a.result.then(function(){o.destroy({success:function(){t.success("Post deleted")},error:function(){}})},function(){r.info("Cancel"),t.warning("Delete cancelled")})}}])}(angular,toastr);var angular=angular||null;!function(e){"use strict";e.factory("PostDataService",["$log","$q","$http","SessionService",function(e,t,o,r){var n="https://api.parse.com/1/classes/Post",a={};return a.getPost=function(e){var t={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+'?where={"slug":"'+e+'"}'};return o(t)},a.getPosts=function(){var e={headers:{"X-Parse-Session-Token":r.sessionToken},isArray:!1,method:"GET",url:n+'?where={"published":true}&count=1&limit=1000&order=-publishDate'};return o(e)},a.deletePost=function(e){var t={headers:{"X-Parse-Session-Token":r.sessionToken},method:"DELETE",url:n+"/"+e.objectId};return o(t)},a}])}(angular.module("app"));