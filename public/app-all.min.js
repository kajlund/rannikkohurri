!function(e){"use strict";var o=e.module("app",["ngRoute","ngAnimate","infinite-scroll","mgcrea.ngStrap","ngGrid","angular-loading-bar","LocalStorageModule"]);o.config(["$routeProvider","$locationProvider","$httpProvider","$modalProvider",function(o,t,n,r){Parse.initialize("HZAMesseJ6CDe1K5dFLfxbGbMYD6aV3lBaEp3Ib1","BxuS4AKpUCoP6Ea6pOn1O0PXlmPu5wYvvlSxLJVE"),n.defaults.headers.common["X-Parse-Application-Id"]="HZAMesseJ6CDe1K5dFLfxbGbMYD6aV3lBaEp3Ib1",n.defaults.headers.common["X-Parse-REST-API-Key"]="LZqwu8VIutbaphzVoPW7yf4RxkKQAMbAapwubT5L",e.extend(r.defaults,{animation:"am-fade-and-scale",placement:"center",html:!0}),o.when("/",{templateUrl:"app/home.html",controller:"HomeController"}).when("/books",{templateUrl:"app/books/list.html",controller:"BookListController",controllerAs:"vm"}).when("/books/view/:bookId",{templateUrl:"app/books/view.html",controller:"BookViewController",controllerAs:"vm"}).when("/books/edit/:bookId",{templateUrl:"app/books/edit.html",controller:"bookEditController",controllerAs:"vm"}).when("/movies",{templateUrl:"app/movies/list.html",controller:"movieListController"}).when("/movies/:movieId",{templateUrl:"app/movies/edit.html",controller:"movieEditController"}).when("/events",{templateUrl:"app/events/list.html",controller:"EventListController"}).when("/events/:eventId",{templateUrl:"app/events/edit.html",controller:"eventEditController"}).otherwise({redirectTo:"/"})}]),o.run(["$log","$window",function(e,o){o.toastr.options.timeOut=2e3,o.toastr.options.positionClass="toast-bottom-right",e.info("App Loaded")}]),o.directive("aDisabled",function(){return{restrict:"A",priority:-99999,link:function(e,o,t){e.$watch(t.aDisabled,function(n,r){n?o.unbind("click"):r&&o.bind("click",function(){e.$apply(t.ngClick)})})}}})}(angular),function(e,o){"use strict";e.module("app").controller("headerController",["$scope","$location","$log","$modal","SessionService",function(e,t,n,r,i){var a=r({scope:e,template:"app/signon.html",show:!1});e.session=i,e.user={name:"",pwd:""},e.getClass=function(e){var o="";return t.path().substr(0,e.length)===e&&(o="active"),o},e.login=function(){a.hide(),i.signon(e.user.name,e.user.pwd).then(function(){o.info(i.userObj.username+" signed on")},function(e){o.error(e.error)})},e.onSignonClick=function(){a.$promise.then(a.show)},e.onSignoffClick=function(){n.info("Signing off"),i.signoff(),o.warning("User signed off")}}])}(angular,toastr),function(e){"use strict";e.module("app").controller("HomeController",["$scope","$log","SessionService",function(e,o,t){e.session=t,o.info("Activating HomeController"),t.loggedOn()||(o.info("not logged on"),t.autoSignon().then(function(){o.info(e.session)},function(e){o.error(e)}))}])}(angular),function(e){"use strict";e.factory("SessionService",["$rootScope","$http","$log","$q","localStorageService",function(e,o,t,n,r){function i(e){s.userObj=e,s.sessionToken=e.sessionToken,r.set("ParseUser",e),Parse.User.become(e.sessionToken).then(function(e){t.info("*** Parse user set to %o",e)},function(){t.error("The Parse user could not be set")})}function a(){s.userObj=null,s.sessionToken="",r.remove("ParseUser"),Parse.User.logOut()}var s={};return s.sessionToken="",s.userObj=null,s.autoSignon=function(){var e=r.get("ParseUser"),a={headers:{"X-Parse-Application-Id":"HZAMesseJ6CDe1K5dFLfxbGbMYD6aV3lBaEp3Ib1","X-Parse-REST-API-Key":"LZqwu8VIutbaphzVoPW7yf4RxkKQAMbAapwubT5L","X-Parse-Session-Token":e?e.sessionToken:""},method:"GET",url:"https://api.parse.com/1/users/me"},s=n.defer();return e&&e.sessionToken.length>10?o(a).success(function(e){t.info("autoSignon success, data = %o",e),i(e),s.resolve(e)}).error(function(e){s.reject(e.error)}):s.reject("Invalid Cookie"),s.promise},s.loggedOn=function(){return null!==s.userObj},s.signoff=function(){a()},s.signon=function(e,t){var r="?username="+e+"&password="+t,s={method:"GET",url:" https://api.parse.com/1/login"+r};return o(s).then(function(e){return"object"==typeof e.data?(i(e.data),e.data):(a(),n.reject(e.data))},function(e){return a(),n.reject(e.data)})},s}])}(angular.module("app")),function(){"use strict";function e(e,o,t,n,r){var i=this;i.session=n,i.bookId=e.bookId,i.languages=["swe","eng","fin"],i.genres=["Biography","History","Kids","Misc","Novel","Science","Technology"],i.getReturnUrl=function(){return"_new"===i.bookId?"/books":"/books/view/"+i.bookId},i.save=function(){r.updateItem(i.book).then(function(e){t.info("Saved Book %o",e),toastr.success("Book saved"),o.url(i.getReturnUrl())},function(e){t.error("Error saving Book %o",e),toastr.error(e.error.code+" "+e.error.error)})},i.cancel=function(){t.info("Cancelled Edit"),toastr.warning("Edit cancelled"),o.url(i.getReturnUrl())},"_new"===i.bookId?i.book={authors:"",genre:"",image:"",lang:"",subtitle:"",title:""}:r.getItem(i.bookId).then(function(e){i.book=e.data},function(e){t.error(e),toastr.error(e.error.code+" "+e.error.error),o.url(i.getReturnUrl())})}e.$inject=["$routeParams","$location","$log","SessionService","bookDataService"],angular.module("app").controller("bookEditController",e)}(),function(){"use strict";function e(e,o,t,n,r){function i(e,t){r.start(),n.queryData(e,t).then(function(e){a.items=e},function(e){o.error("Error fetching Book data %o",e),toastr.error(e.message)}).then(function(){r.complete()})}var a=this;a.searchFields=[{name:"title",description:"By Title"},{name:"subtitle",description:"By Subtitle"},{name:"authors",description:"By Authors"}],a.currentSearchField=a.searchFields[0],a.search=function(){i(a.currentSearchField.name,a.searchKey)},a.onAddClick=function(){e.path("/books/edit/_new")},a.session=t,a.searchKey="",a.currentItem=null,a.items=[],o.info("Activating bookListController"),t.loggedOn()||t.autoSignon().then(function(e){toastr.success(e.username+" signed on"),o.debug("[ctrlBookList.autoSignon] success %o",e)},function(e){o.debug("[ctrlBookList.autoSignon] error %o",e)}),i("title","")}e.$inject=["$location","$log","SessionService","bookDataService","cfpLoadingBar"],angular.module("app").controller("BookListController",e)}(),function(){"use strict";function e(e,o,t,n,r,i,a){function s(){a.getItem(c).then(function(e){u.book=e.data},function(e){n.error(e),toastr.error(e.error.code+" "+e.error.error),o.url("/books")}).then(function(){u.loggedOn=i.loggedOn(),n.info("*** Activated BookViewController"),n.debug("   bookId      => %s",c),n.debug("   vm.book     => %o",u.book),n.debug("   vm.loggedOn => "+u.loggedOn)})}var l,u=this,c=t.bookId;u.canEdit=function(){return u.loggedOn&&c},u.edit=function(){o.path("/books/edit/"+c)},u.delete=function(){l=r({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Book?",content:"You are about to delete book <em>"+u.book.title+"</em>"})},e.dlgVerifyCancel=function(){l.hide()},e.dlgVerifyOK=function(){l.hide(),a.deleteItem(c).then(function(e){n.info("Deleted Book %o",e),toastr.success("Book deleted"),o.url("/books")},function(e){n.error(e),toastr.error(e.error.code+" "+e.error.error)})},i.loggedOn()?s():i.autoSignon().then(function(e){toastr.success(e.username+" signed on"),n.debug("[ctrlBookView.autoSignon] success %o",e)},function(e){n.debug("[ctrlBookView.autoSignon] error %o",e)}).then(function(){s()})}e.$inject=["$scope","$location","$routeParams","$log","$modal","SessionService","bookDataService"],angular.module("app").controller("BookViewController",e)}(),function(){"use strict";function e(e,o,t){var n={},r="https://api.parse.com/1/classes/AudioBook",i=Parse.Object.extend("AudioBook"),a=100;return n.getItem=function(o){var n={headers:{"X-Parse-Session-Token":t.sessionToken},isArray:!1,method:"GET",url:r+"/"+o};return e(n)},n.getItems=function(){var o={headers:{"X-Parse-Session-Token":t.sessionToken},isArray:!1,method:"GET",url:r+"?count=1&limit=1000&order=title"};return e(o)},n.getPage=function(o,n,i){var s=""===n?"":'&where={"'+o+'":{"$gte":"'+n+'"}}',l=(i-1)*a,u="?count=1&limit="+a+"&skip="+l+"&order="+o+s,c={headers:{"X-Parse-Session-Token":t.sessionToken},isArray:!1,method:"GET",url:r+u};return e(c)},n.queryData=function(e,t){var n=new Parse.Query(i),r=o.defer();return n.startsWith(e,t),n.find({success:function(e){r.resolve(e)},error:function(e){r.reject(e)}}),r.promise},n.updateItem=function(o){var n=void 0===o.objectId,i=n?r+"/":r+"/"+o.objectId,a={headers:{"X-Parse-Session-Token":t.sessionToken},method:n?"POST":"PUT",url:i,data:o};return e(a)},n.deleteItem=function(o){var n=r+"/"+o,i={headers:{"X-Parse-Session-Token":t.sessionToken},method:"DELETE",url:n};return e(i)},n}e.$inject=["$http","$q","SessionService"],angular.module("app").factory("bookDataService",e)}(),function(e){"use strict";e.controller("cheatsEditController",["$scope","$routeParams","$location","$log","SessionService","cheatsDataService",function(e,o,t,n,r,i){e.session=r,e.cacheId=o.cacheId,e.cacheTypes=["Tradi","Mystery","Multi","Chirp","Earth","Letterbox","Event","Lab","Virtual","Wherigo"],e.municipalities=["Akaa","Alajärvi","Alavieska","Alavus","Asikkala","Askola","Aura","Brändö","Eckerö","Enonkoski","Enontekiö","Espoo","Eura","Eurajoki","Evijärvi","Finström","Forssa","Föglö","Geta","Haapajärvi","Haapavesi","Hailuoto","Halsua","Hamina","Hammarland","Hankasalmi","Hanko","Harjavalta","Hartola","Hattula","Hausjärvi","Heinola","Heinävesi","Helsinki","Hirvensalmi","Hollola","Honkajoki","Huittinen","Humppila","Hyrynsalmi","Hyvinkää","Hämeenkoski","Hämeenkyrö","Hämeenlinna","Ii","Iisalmi","Iitti","Ikaalinen","Ilmajoki","Ilomantsi","Imatra","Inari","Inkoo","Isojoki","Isokyrö","Jalasjärvi","Janakkala","Joensuu","Jokioinen","Jomala","Joroinen","Joutsa","Juankoski","Juuka","Juupajoki","Juva","Jyväskylä","Jämijärvi","Jämsä","Järvenpää","Kaarina","Kaavi","Kajaani","Kalajoki","Kangasala","Kangasniemi","Kankaanpää","Kannonkoski","Kannus","Karijoki","Karkkila","Karstula","Karvia","Kaskinen","Kauhajoki","Kauhava","Kauniainen","Kaustinen","Keitele","Kemi","Kemijärvi","Keminmaa","Kemiönsaari","Kempele","Kerava","Keuruu","Kihniö","Kinnula","Kirkkonummi","Kitee","Kittilä","Kiuruvesi","Kivijärvi","Kokemäki","Kokkola","Kolari","Konnevesi","Kontiolahti","Korsnäs","Koski Tl","Kotka","Kouvola","Kristiinankaupunki","Kruunupyy","Kuhmo","Kuhmoinen","Kumlinge","Kuopio","Kuortane","Kurikka","Kustavi","Kuusamo","Kyyjärvi","Kärkölä","Kärsämäki","Kökar","Köyliö","Lahti","Laihia","Laitila","Lapinjärvi","Lapinlahti","Lappajärvi","Lappeenranta","Lapua","Laukaa","Lavia","Lemi","Lemland","Lempäälä","Leppävirta","Lestijärvi","Lieksa","Lieto","Liminka","Liperi","Lohja","Loimaa","Loppi","Loviisa","Luhanka","Lumijoki","Lumparland","Luoto","Luumäki","Luvia","Maalahti","Maaninka","Maarianhamina","Marttila","Masku","Merijärvi","Merikarvia","Miehikkälä","Mikkeli","Muhos","Multia","Muonio","Mustasaari","Muurame","Mynämäki","Myrskylä","Mäntsälä","Mänttä-Vilppula","Mäntyharju","Naantali","Nakkila","Nastola","Nivala","Nokia","Nousiainen","Nurmes","Nurmijärvi","Närpiö","Orimattila","Oripää","Orivesi","Oulainen","Oulu","Outokumpu","Padasjoki","Paimio","Paltamo","Parainen","Parikkala","Parkano","Pedersöre","Pelkosenniemi","Pello","Perho","Pertunmaa","Petäjävesi","Pieksämäki","Pielavesi","Pietarsaari","Pihtipudas","Pirkkala","Polvijärvi","Pomarkku","Pori","Pornainen","Porvoo","Posio","Pudasjärvi","Pukkila","Punkalaidun","Puolanka","Puumala","Pyhtää","Pyhäjoki","Pyhäjärvi","Pyhäntä","Pyhäranta","Pälkäne","Pöytyä","Raahe","Raasepori","Raisio","Rantasalmi","Ranua","Rauma","Rautalampi","Rautavaara","Rautjärvi","Reisjärvi","Riihimäki","Ristijärvi","Rovaniemi","Ruokolahti","Ruovesi","Rusko","Rääkkylä","Saarijärvi","Salla","Salo","Saltvik","Sastamala","Sauvo","Savitaipale","Savonlinna","Savukoski","Seinäjoki","Sievi","Siikainen","Siikajoki","Siikalatva","Siilinjärvi","Simo","Sipoo","Siuntio","Sodankylä","Soini","Somero","Sonkajärvi","Sotkamo","Sottunga","Sulkava","Sund","Suomussalmi","Suonenjoki","Sysmä","Säkylä","Taipalsaari","Taivalkoski","Taivassalo","Tammela","Tampere","Tarvasjoki","Tervo","Tervola","Teuva","Tohmajärvi","Toholampi","Toivakka","Tornio","Turku","Tuusniemi","Tuusula","Tyrnävä","Ulvila","Urjala","Utajärvi","Utsjoki","Uurainen","Uusikaarlepyy","Uusikaupunki","Vaala","Vaasa","Valkeakoski","Valtimo","Vantaa","Varkaus","Vehmaa","Vesanto","Vesilahti","Veteli","Vieremä","Vihti","Viitasaari","Vimpeli","Virolahti","Virrat","Vårdö","Vöyri","Ylitornio","Ylivieska","Ylöjärvi","Ypäjä","Ähtäri","Äänekoski"],"_new"===e.cacheId?e.cache={cacheId:"",cacheType:"",name:"",coords:"",verifiedCoords:!1}:i.getItem(e.cacheId).then(function(o){e.cache=o.data,e.currentType=e.cache.cacheType},function(e){n.error(e),toastr.error(e.error.code+" "+e.error.error),t.url("/cheats")}),e.save=function(){i.updateItem(e.cache).then(function(e){n.info("Saved Cache %o",e),toastr.success("Cache saved"),t.url("/cheats")},function(e){n.error("Error saving Cache %o",e),toastr.error(e.error.code+" "+e.error.error),t.url("/cheats")})},e.cancel=function(){n.info("Cancelled Edit"),toastr.warning("Edit cancelled"),t.url("/cheats")}}])}(angular.module("app")),function(e){"use strict";e.controller("cheatsListController",["$scope","$location","$log","$modal","SessionService","cheatsDataService",function(e,o,t,n,r,i){function a(){r.userObj&&i.getItems().then(function(o){t.info(o),e.items=o.data.results},function(e){t.error(e),toastr.error(e.data.code+" "+e.data.error)})}var s=null,l='<div class="ngCellText" ng-class="col.colIndex()">  <a target="_blank" href="http://coord.info/{{row.entity.cacheId}}">{{row.getProperty(col.field)}}</a></div>',u='<div class="ngCellText" ng-class="col.colIndex()">  <div class="btn-group">    <button type="button" class="btn btn-primary" data-ng-click="onEditClick(row.entity)">        <i class="fa fa-edit"></i>    </button>    <button type="button" class="btn btn-danger" data-ng-click="onDeleteClick(row.entity)">      <i class="fa fa-trash-o"></i>    </button>  </div></div>';e.gridOptions={data:"items",rowHeight:44,multiSelect:!1,showGroupPanel:!0,columnDefs:[{field:"cacheId",displayName:"Id",width:"100",cellTemplate:l},{field:"updatedAt",displayName:"Updated",cellFilter:"date",width:"100"},{field:"cacheType",displayName:"Type",width:"100"},{field:"name",displayName:"Name"},{field:"municipality",displayName:"Municipality",width:"150"},{field:"coords",displayName:"Coords"},{field:"verifiedCoords",displayName:"Verified",width:"66"},{field:"objectId",displayName:"Commands",width:"86",cellTemplate:u}]},e.session=r,e.totalItems=0,e.currentItem=null,e.onAddClick=function(){o.path("/cheats/_new")},e.onEditClick=function(e){o.path("/cheats/"+e.objectId)},e.onDeleteClick=function(o){e.currentItem=o,s=n({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Cache?",content:"You are about to delete cache <strong>"+o.name+"</strong>"})},e.dlgVerifyCancel=function(){s.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){s.hide(),i.deleteItem(e.currentItem).then(function(){t.info("Deleted Cache"),toastr.success("Cache deleted"),e.items=_.filter(e.items,function(o){return o.objectId!==e.currentItem.objectId})},function(e){t.error(e),toastr.error(e.error.code+" "+e.error.error)})},r.loggedOn()||r.autoSignon().then(function(){t.info(e.session)},function(e){t.error(e)}),a()}])}(angular.module("app")),function(e){"use strict";e.factory("cheatsDataService",["$log","$q","$http","SessionService",function(e,o,t,n){var r="https://api.parse.com/1/classes/Cheat",i={};return i.municipalities=[],i.getItem=function(e){var o={headers:{"X-Parse-Session-Token":n.sessionToken},isArray:!1,method:"GET",url:r+"/"+e};return t(o)},i.getItems=function(){var e={headers:{"X-Parse-Session-Token":n.sessionToken},isArray:!1,method:"GET",url:r+"?count=1&limit=1000&order=name"};return t(e)},i.updateItem=function(e){var o=void 0===e.objectId,i=o?r+"/":r+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":n.sessionToken},method:o?"POST":"PUT",url:i,data:e};return t(a)},i.deleteItem=function(e){var o=r+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":n.sessionToken},method:"DELETE",url:o};return t(i)},i}])}(angular.module("app")),function(e){"use strict";e.controller("eventEditController",["$scope","$routeParams","$location","$log","SessionService","eventDataService",function(e,o,t,n,r,i){e.session=r,e.eventId=o.eventId,"_new"===e.eventId?e.event={starts:"",eventName:"",placeName:"",organizer:"",organizerUrl:"",smartum:!1}:i.getEvent(e.eventId).then(function(o){e.event=o.data},function(e){n.error(e),toastr.error(e.error.code+" "+e.error.error),t.url("/events")}),e.save=function(){i.updateItem(e.event).then(function(e){n.info("Saved Event %o",e),toastr.success("Event saved"),t.url("/events")},function(e){n.error("Error saving Event %o",e),toastr.error(e.error.code+" "+e.error.error),t.url("/events")})},e.cancel=function(){n.info("Cancelled Edit"),toastr.warning("Edit cancelled"),t.url("/events")}}])}(angular.module("app")),function(e){"use strict";e.controller("EventListController",["$scope","$location","$log","$modal","SessionService","eventDataService",function(e,o,t,n,r,i){function a(){i.getEvents().then(function(o){e.events=o.data.results},function(e){t.error(e),toastr.error(e.error.code+" "+e.error.error)})}var s=null;e.session=r,e.totalItems=0,e.currentItem=null,e.onAddClick=function(){o.path("/events/_new")},e.onEditClick=function(e){o.path("/events/"+e.objectId)},e.onDeleteClick=function(o){e.currentItem=o,s=n({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Event?",content:"You are about to delete event <em>"+o.eventName+"/"+o.placeName+"</em>"})},e.dlgVerifyCancel=function(){s.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){s.hide(),i.deleteItem(e.currentItem).then(function(){t.info("Deleted Event"),toastr.success("Event deleted"),e.events=_.filter(e.events,function(o){return o.objectId!==e.currentItem.objectId})},function(e){t.error(e),toastr.error(e.error.code+" "+e.error.error)})},r.loggedOn()||r.autoSignon().then(function(){t.info(e.session)},function(e){t.error(e)}),a()}])}(angular.module("app")),function(e){"use strict";e.factory("eventDataService",["$log","$q","$http","SessionService",function(e,o,t,n){var r="https://api.parse.com/1/classes/Event",i={};return i.getEvent=function(e){var o={isArray:!1,method:"GET",url:r+"/"+e};return t(o)},i.getEvents=function(){var e={isArray:!1,method:"GET",url:r+"?count=1&limit=1000&order=starts"};return t(e)},i.updateItem=function(e){var o=void 0===e.objectId,i=o?r+"/":r+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":n.sessionToken},method:o?"POST":"PUT",url:i,data:e};return t(a)},i.deleteItem=function(e){var o=r+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":n.sessionToken},method:"DELETE",url:o};return t(i)},i}])}(angular.module("app")),function(e,o){"use strict";e.controller("movieEditController",["$scope","$routeParams","$location","$log","SessionService","movieDataService",function(e,t,n,r,i,a){e.session=i,e.movieId=t.movieId,"_new"===e.movieId?e.movie={seenAt:{__type:"Date",iso:(new Date).toISOString()},etitle:"",otitle:"",pic:"",rating:0,url:"",synopsis:"",comment:""}:a.getItem(e.movieId).then(function(o){e.movie=o.data},function(e){r.error(e),o.error(e.error.code+" "+e.error.error),n.url("/movies")}),e.save=function(){a.updateItem(e.movie).then(function(e){r.info("Saved Movie %o",e),o.success("Movie saved"),n.url("/movies")},function(e){r.error("Error saving Movie %o",e),o.error(e.error.code+" "+e.error.error),n.url("/movies")})},e.cancel=function(){r.info("Cancelled Edit"),o.warning("Edit cancelled"),n.url("/movies")}}])}(angular.module("app"),toastr),function(e){"use strict";e.controller("movieListController",["$scope","$location","$modal","$log","SessionService","movieDataService",function(e,o,t,n,r,i){function a(){e.fetching||(e.fetching=!0,i.getPage(e.order,e.filter,e.currentPage).then(function(o){e.items=e.items.concat(o.data.results),e.totalItems=o.data.count,e.fetching=!1},function(o){n.error(o),toastr.error(o.error.code+" "+o.error.error),e.fetching=!1}))}var s=null;e.session=r,e.filter="",e.currentPage=1,e.maxSize=10,e.order="-seenAt",e.totalItems=0,e.currentItem=null,e.items=[],e.fetching=!1,e.onAddClick=function(){o.path("/movies/_new")},e.onEditClick=function(e){o.path("/movies/"+e.objectId)},e.onDeleteClick=function(o){e.currentItem=o,s=t({scope:e,template:"app/tmplVerify.html",show:!0,title:"Delete Movie?",content:"You are about to delete movie <em>"+o.etitle+"</em>"})},e.dlgVerifyCancel=function(){s.hide(),toastr.warning("Delete cancelled")},e.dlgVerifyOK=function(){s.hide(),i.deleteItem(e.currentItem).then(function(){n.info("Deleted Movie"),toastr.success("Movie deleted"),e.items=_.filter(e.items,function(o){return o.objectId!==e.currentItem.objectId})},function(e){n.error(e),toastr.error(e.error.code+" "+e.error.error)})},e.scroll=function(){e.currentPage+=1,a()},r.loggedOn()||r.autoSignon().then(function(){n.info(e.session)},function(e){n.error(e)}),a()}])}(angular.module("app")),function(e){"use strict";e.service("movieDataService",["$log","$q","$http","SessionService",function(e,o,t,n){var r="https://api.parse.com/1/classes/Movie",i=100,a=function(e){var o={headers:{"X-Parse-Session-Token":n.sessionToken},isArray:!1,method:"GET",url:r+"/"+e};return t(o)},s=function(){var e={headers:{"X-Parse-Session-Token":n.sessionToken},isArray:!1,method:"GET",url:r+"?count=1&limit=1000&order=-seenAt"};return t(e)},l=function(e,o,i){var a=""===o?"":'&where={"'+e+'":{"$gte":"'+o+'"}}',s=(i-1)*this.pageSize,l="?count=1&limit="+this.pageSize+"&skip="+s+"&order="+e+a,u={headers:{"X-Parse-Session-Token":n.sessionToken},isArray:!1,method:"GET",url:r+l};return t(u)},u=function(e){var o=void 0===e.objectId,i=o?r+"/":r+"/"+e.objectId,a={headers:{"X-Parse-Session-Token":n.sessionToken},method:o?"POST":"PUT",url:i,data:e};return t(a)},c=function(e){var o=r+"/"+e.objectId,i={headers:{"X-Parse-Session-Token":n.sessionToken},method:"DELETE",url:o};return t(i)};return{pageSize:i,getItem:a,getItems:s,getPage:l,updateItem:u,deleteItem:c}}])}(angular.module("app"));